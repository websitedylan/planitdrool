<script>
  const btn = document.getElementById('menuBtn');
  const menu = document.getElementById('mobileMenu');
  btn?.addEventListener('click', () =>{
    const open = menu.hasAttribute('hidden');
    if(open){ menu.removeAttribute('hidden'); btn.setAttribute('aria-expanded','true'); }
    else{ menu.setAttribute('hidden',''); btn.setAttribute('aria-expanded','false'); }
  });
  document.getElementById('year').textContent = new Date().getFullYear();

  (function(){
    const form = document.getElementById('contactForm');
    const note = document.getElementById('formNote');
    const btn  = document.getElementById('sendBtn');
    if(!form) return;
    form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      if(document.getElementById('website')?.value){ return; }
      btn.disabled = true; btn.textContent = 'Sendingâ€¦'; note.textContent = '';
      const data = Object.fromEntries(new FormData(form).entries());
      try{
        const res = await fetch(form.action, {
          method: 'POST',
          headers: { 'Accept': 'application/json', 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        if(res.ok){
          form.reset();
          note.style.color = '#88f0a1';
          note.textContent = 'Thanks! Your message was sent.';
        } else {
          note.style.color = '#ff9aa2';
          note.textContent = 'Something went wrong. Try again or email me directly.';
        }
      }catch(err){
        note.style.color = '#ff9aa2';
        note.textContent = 'Network error. Please try again.';
      } finally{
        btn.disabled = false; btn.textContent = 'Send';
      }
    });
  })();
</script>

